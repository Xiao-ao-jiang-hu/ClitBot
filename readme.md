<!--
#参数
同层的：向右下，x+85，y+25
向左下：x-80，y+20
叠层：y-70
-->
## 一、项目背景
旅行者结束了一天的冒险，突然发现尘歌壶里出现了新的地图和锚点。本着不放过视野里任何一个未解锁锚点的原则，旅行者决定解锁新地图上所有未解锁的锚点。但是旅行者的体力条有限，一次只能攀爬一个石头的高度。旅行者想要寻求帮助，但旅行者的向导派蒙和超级大白化漂浮灵一样笨。你能帮帮旅行者吗？
## 二、项目环境
### 主体环境
2022版Visual Studio, 64位 Windows 10操作系统

### 依赖项
Windows.h

stdc++库


## 三、小组成员及项目分工
王思图：绘制模块、显示模块、写文档、过程设计、文件结构设计


## 四、程序运行过程
### 1.读入地图文件

传入参数：地图文件地址和名称

需要模块：读地图文件模块，参数为地图文件地址和名称，返回值为存有初始地图的map结构体

### 2.展示地图+输入指令
等待输入指令

传入参数：输入的指令

需要模块：读指令模块，无参数，返回值为指令序列数组；显示模块，展示初始地图

### 3.计算每步状态
根据初始地图和输入指令，计算每执行一个指令后地图和机器人状态

传入参数：存有初始地图的map结构体，指令序列数组

需要的模块：计算模块，参数为存有初始地图的map结构体，指令序列结构体数组，返回值为状态结构体数组，数组每个元素为执行一个指令后的游戏状态结构体，游戏状态结构体应包括机器人状态和地图状态的信息

### 4.根据输出的计算状态绘图
根据过程数组绘制每步的地图

传入参数：游戏状态结构体数组

需要的模块：绘图模块，根据游戏状态结构体绘制每步的情形并存盘

返回值：保存文件的路径数组

传出显示每步状态的bmp文件

### 5.显示状态
在命令行里逐一显示状态图片

需要的模块：显示模块

传入参数：保存路径数组

功能：在命令行里逐张显示状态图片

## 五、公共结构规定

### 位置
```cpp
struct Position {
	int x, y; // x 表示列号，y 表示行号 
};
```
### 机器人
```cpp
struct Robot {
	Position pos; // 机器人位置 
	int direction; // 机器人朝向，1前，2左，3下，4右
};
```

### 单元格
```cpp
struct Cell {
	int height; // 高度 
	bool robot; // true/false分别表示机器人在/不在该单元格上
	int light;//灯状态，0代表没有灯，1代表有灯没点亮，2代表有灯且点亮
};
```
### 一个地图状态
```cpp
struct Map {
	// 单元格组成二维数组，MAX_ROW、MAX_COL为合理常数 
	Cell cells[MAX_ROW][MAX_COL]; 
	// 有效行数、有效列数
	int row, col; 
	//已经点亮的灯数
	int num_lights;
	// 机器人状态
	Robot robot;
};
```
### 指令序列
```cpp
enum OpType { TL, TR, MOV, JMP, LIT, CALL, P1, P2}; 
// TL为左转，TR为右转，MOV为向前行走，JMP为跳跃，LIT为点亮灯，P1和P2代表函数指令序列； 
// 使用CALL表示调用MAIN，P1/2表示调用P1/2。
```

## 六、代码结构
### defines.h
包含所有的公共变量定义

### draw.h
包含绘制单步状态模块

实现为draw()函数

参数：WritePath(char*), map(Map)

第一个代表存盘路径及文件名

第二个代表某步操作后的map状态

### show.h
包含图片展示模块

参数：ImgPath(char*)

代表要展示的图片的路径及文件名

### draw_all.h
包含绘制多步模块

实现为draw_all()函数

参数：output_path(char*), steps(int), maps(Map*)

第一个代表输出文件夹

第二个代表除初始状态外有多少个需要绘制的地图状态

第三个代表包含所有地图状态的地图结构体数组

## 七、开发日志
### Nov.17
进行项目结构和逻辑的设计

对项目实现进行了拆分

设计了绘图逻辑

### Nov.18
研究了位图文件结构，学习如何在像素层面操作图像，在原神中截取资源图像并抠图，成功利用c++读入图片并保存文件

### Nov.19
研究了windows自带的图形界面接口，尝试了在命令行中输出图像，完成第一版show函数（逐个更改命令行像素的RGB值）

尝试同时读入两张图片并组合

规定了公共数据结构

### Nov.20
尝试同时读入多张图片并组合，并将此功能封装在一个函数中

分割了已写的几个功能，规范了代码结构

### Nov.21
进一步研究了windows自带的图形界面接口，改进了show函数，图形显示速度极大幅度提升

添加draw_all.h头文件，包含draw_all函数，可一次性画完所有步骤并输出为不同名称的文件

开始研究GUI界面
